openapi: 3.0.1
info:
  title: 2-Way SMS HTTP API
  description: >
    Welcome to the 2-Way SMS HTTP API documentation.
    
    
    This document provides detailed information for learning, testing, and implementing the 2-Way SMS HTTP API.


    # Overview

     This document outlines the Two-Way SMS HTTP API, covering features such as sending chat messages, querying received messages, and obtaining user status reports—all achievable through a single request.


     This API is based on the HTTP protocol, supports GET and POST requests, and handles multi-tasking and status updates via JSON arrays.


     The HTTP message body consists of one or more JSON-formatted strings. 
     
     
     **Except for MMS-related APIs, the HTTP header parameter “Content-Type” must be set to “application/json;charset=utf-8”.**


     # Getting Started

     Two key parameters are required for device communication:

     **IP: The public network address of the server**

     **The default port for the HTTP API is 20003**
     
     <span style="text-decoration: underline;font-weight: bold;font-style: italic;color: red">Note: The `Password` parameter in the EIMS API has two scenarios:
     - 1. When the server does not encrypt, it is a plaintext password.
     - 2. When the server encrypts, it is an MD5-hashed password.</span>
     
     
     <span style="text-decoration: underline;font-weight: bold;font-style: italic;color: red">The MD5 value is calculated as: md5(username + plaintext password + seq + time + negotiated key).
     The negotiated key is provided by the server.</span>

     When calling the API, the complete request URL must include the values for these parameters.
  version: 1.2.0
  x-logo:
    url: ./EAPI-logo.png
    backgroundColor: '#FAFAFA'
    altText: SMS logo
paths:
  http://ip:20003/chat_submit:
    post:
      summary: Chat Bulk Send (SMS)
      deprecated: false
      description: Supports submitting chat messages via HTTP POST requests. The default message sent is the initial push notification
      requestBody:
        content:
          application/json:
            example:
              account: test
              password: 12345
              seq: 12
              charset: UTF8
              content: hello
              array:
                - receiver: 10086
                  content: hello sms
                - receiver: 10001    
            schema:
              required:
                - account
                - password
                - seq
                - array
              properties:
                version:
                  type: string(8)
                  description: Protocol version number
                  default: '1.0'
                account:
                  type: string(32)
                  description: Account
                password:
                  type: string(32)
                  description: Password
                seq:
                  type: int
                  description: >-
                    Serial number，increments per request，the initial value is 1
                time:
                  type: int
                  description: >-
                    The timestamp form which the request was mode
                    
                    
                      **Must be filled when the server requires encryption**
                content:
                  type: string(1024)
                  description: Global SMS content. **This field may be left blank when the content field in the array contains a non-empty value**
                charset:
                  type: string(6)
                  description: Content encoding, UTF8 or BASE64
                  default: UTF8
                array:
                  type: array
                  description: An array of multiple independent SMS content strings for bulk sending
                  items:
                    type: object
                    required:
                      - receiver
                    properties:
                      receiver:
                        type: string(1024)
                        description: Recipient phone number(s), multiple numbers separated by commas
                      content: 
                        type: string(1024)
                        description: SMS content; if empty, global content is used
      responses:
        '200':
          description: 'OK'
          content:
            application/json:
              schema:
                type: object
                required:
                  - version
                  - seq
                  - status
                  - reason
                  - fail
                  - success
                  - array
                properties:
                   version: 
                     type: string
                     description: Protocol version
                     default: 'V1.0'
                   seq:
                     type: int
                     description: Sequence number from request, if provided, returned
                   status:
                     type: int
                     description: >-
                       Query status
                        - 0：success
                        - non-zero = failure
                   reason:
                     type: string
                     description: Failure reason,
                   fail:
                     type: int
                     description: Number of failed submissions
                   success:
                     type: int
                     description: Number of successful submissions
                   array:
                     type: array
                     description: Array of successful submission details
                     items:
                       required:
                         - msgId
                         - chatId
                         - receiver
                       properties:
                         msgId:
                           type: string
                           description: System-generated message ID for tracking delivery reports
                         chatId:
                           type: string
                           description: System-generated chatId, for reports and replies
                         receiver:
                           type: string
                           description: Single recipient phone number, one per msgId
                       
              examples:
                '1':
                  summary: Successful instance
                  value:
                    version: V1.0
                    seq: 12
                    status: 0
                    reason: success
                    success: 2
                    fail: 0
                    array:
                      - msgId: 123456
                        chatId: 123456
                        receiver: 10086
                      - msgId: 123457
                        chatId: 123457
                        receiver: 10001
          headers: {}
      security: []

  http://ip:20003/chat_submit_mms:
    post:
      summary: Chat Bulk Send (MMS)
      deprecated: false
      description: |
         Submission via multipart form. First form named `mms_body` contains JSON similar to `Chat Bulk Send(SMS)`, including an additional title field for MMS subject
         
         
         <span style="color:red;font-weight:bold">Subsequent forms contain MMS attachments, named as `<filename>.<extension>`, no directory paths </span>
      
         ![sendmms](https://raw.githubusercontent.com/ejoin-api/eims-chat/main/docs/chatmms.png)
              
      requestBody:
        content:
          multipart/form-data:
            example:
              {"version":"V1.0", "seq":12, "charset":"UTF8", "title":"testTitle", "account":"test", "password":"123456", "array":[{"receiver":"10001", "content":"hello", "title":"title1"}]}
            schema:
              type: object
              properties:
                mms_body:
                  type: string
                  description: >-
                    `mmsbody` must be the first element in the form. 
                    
                    
                    The content format remains consistent with the SMS submission method described above, using JSON format and presented as an array named `smsarray` within the `mms_body` form:
                      - verison, string(8): Protocol version number, default V1.0
                      - account, string(32), **required**: Account
                      - password, string(32), **required**: Password
                      - seq, int, **required**: Sequence number, incremented with each request, initial value is 1
                      - time, int: The timestamp of the request initiation. **Must be filled when the server requires encryption**
                      - content, string(1024): Global SMS content. **This field may be left blank when the content field in the array contains a non-empty value**
                      - title, string(256): MMS subject. When the array contains non-empty content in the field with the same name, this field may be left blank
                      - charset, string(6): Content encoding, UTF8 or BASE64. Default is UTF8
                      - array, **required**, an array of multiple independent SMS content strings for bulk sending, properties: receiver(string,**required**), content(string), title(string)
                      
                filename.extension:
                  description: Subsequent form fields represent MMS attachments. Attachment names should be simple, without directory paths—use only the format  `filename.extension`
                  type: file   
        
      responses:
        '200':
          description: 'OK'
          content:
            application/json:
              schema:
                type: object
                required:
                  - status
                  - success
                  - fail
                  - array
                properties:
                   version:
                     type: string
                     description: Protocol version 
                     default: V1.0
                   seq:
                     type: int
                     description: Sequence number from request, if provided, returned
                   status:
                     type: int
                     description: >-
                       Send submission status
                        - 0:query success
                        - 1:authentication error
                        - 2:Ip limited access
                        - 3:SMS contain sensitive characters
                        - 4:SMS contain is empty
                        - 5:SMS contain is too long
                        - 6:Not a template SMS
                        - 7:Over number
                        - 8:number is empty
                        - 9:Abnormal number
                        - 10:The channel balance is insufficient to satisfy this transmission
                        - 11:The time is wrong
                        - 12:Because of the platform, batch commit error,please contact the administrator
                        - 13:User locked
                   success:
                     type: int
                     description: The number of successful submissions
                   fail:
                     type: int
                     description: The number of failure submissionss
                   reason:
                     type: string
                     description: Failure reason
                   array:
                     type: array
                     description: Array of successful submission details
                     items:
                       required:
                         - msgId
                         - chatId
                         - receiver
                       properties:
                         msgId:
                           type: string
                           description: System-generated message ID for tracking delivery reports
                         chatId:
                           type: string
                           description: System-generated chatId, for reports and replies
                         receiver:
                           type: string
                           description: Single recipient phone number, one per msgId
                       
              examples:
                '1':
                  summary: Successful instance
                  value:
                    version: V1.0
                    seq: 12
                    status: 0
                    reason: success
                    success: 2
                    fail: 0
                    array:
                      - msgId: 123456
                        chatId: 123456
                        receiver: 10086
                      - msgId: 123457
                        chatId: 123457
                        receiver: 10001
          headers: {}
      security: []
  http://ip:20003/chat_reply:
    post:
      summary: Chat Reply (SMS)
      deprecated: false
      description: >-
        Supports submitting chat replies via HTTP POST. By default, this request sends a secondary forwarded SMS reply message.
      requestBody:
        content:
          application/json:
            example:
              account: test
              password: 12345
              seq: 13
              charset: UTF8
              switch: 1
              chatId: 125
              content: reply    
            schema:
              required:
                - account
                - password
                - content
                - chatId
              properties:
                version:
                  type: string(8)
                  description: Protocol version number
                  default: '1.0'
                account:
                  type: string(32)
                  description: Account
                password:
                  type: string(32)
                  description: Password
                seq:
                  type: int
                  description: >-
                    Serial number，increments per request，the initial value is 1
                     
                     **Required when encryption is enabled**
                time:
                  type: int
                  description: >-
                    The timestamp form which the request was mode
                    
                    
                      **Must be filled when the server requires encryption**
                content:
                  type: string(1024)
                  description: Global SMS content. **This field may be left blank when the content field in the array contains a non-empty value**
                charset:
                  type: string(6)
                  description: Content encoding, UTF8 or BASE64
                  default: UTF8
                chatId:
                  type: string
                  description: >-
                    <span style="color:red;font-weight:bold">The target chat ID returned by the system that requires a reply; no need to specify the chat contact number.</span>
                switch:
                  type: int
                  description: If the original sending SIM card is unavailable, should the system be allowed to automatically switch cards(0 or 1)
                  default: 0
      responses:  
        '200':
          description: 'OK'
          content:
            application/json:
              example:
                version: V1.0
                seq: 13
                status: 0
                reason: success
                msgId: 125
                receiver: 10086
                switch: 0   
              schema:
                type: object
                required:
                  - status
                  - version
                  - seq
                  - reason
                  - msgId
                  - receiver
                  - switch
                properties:
                   version:
                     type: string
                     description: 
                     example: V1.0
                   seq: 
                     type: int
                     description: Sequence number from request, if provided, returned
                   status:
                     type: int
                     description: >-
                       Submission status: 
                        - 0 = success
                        - non-zero = failure
                   reason:
                     type: string
                     description: Failure reason, if any
                   msgId:
                     type: string
                     description: System-generated message ID for tracking delivery reports
                   receiver:
                     type: string
                     description: Single recipient phone number, one per msgId
                   switch:
                     type: int
                     description: Whether card switch occurred (0 or 1)
                   
          headers: {}
      security: []
  http://ip:20003/chat_reply_mms:
    post:
      summary: Chat Reply (MMS)
      deprecated: false
      description: >-
        Supports submitting chat replies via HTTP POST. By default, this request sends a secondary forwarded MMS reply message.
        
        
        <span style="color:red;font-weight:bold">Multipart form submission, first form named mms_body contains JSON similar to SMS reply plus title for MMS subject</span>
        
        
        <span style="color:red;font-weight:bold">Other forms contain attachments named `<filename>.<extension>`, no directory paths</span>
         ![sendmms](https://raw.githubusercontent.com/ejoin-api/eims-chat/main/docs/chatreply.png)
      requestBody:
        content:
          multipart/form-data:
            example:
              {"version":"V1.0", "seq":12, "charset":"UTF8", "switch":0, "chatId":"123456abcd", "title":"testTitle", "content":"hello", "account":"chat", "password":"123456"}
            schema:
              type: object
              properties:
                mms_body:
                  type: string
                  description: >-
                    `mmsbody` must be the first element in the form. 
                    
                    
                    The content format remains consistent with the SMS submission method described above, using JSON format and presented as an array named `smsarray` within the `mms_body` form:
                      - verison, string(8): Protocol version number, default V1.0
                      - account, string(32), **required**: Account
                      - password, string(32), **required**: Password
                      - seq, int: Sequence number, incremented with each request, initial value is 1. **Must be filled when the server requires encryption**
                      - time, int: The timestamp of the request initiation. **Must be filled when the server requires encryption**
                      - chatId, string, **required**: The target chat ID returned by the system that requires a reply; no need to specify the chat contact number
                      - content, string(1024): Global SMS content. **This field may be left blank when the content field in the array contains a non-empty value**
                      - title, string(256): MMS subject. When the array contains non-empty content in the field with the same name, this field may be left blank
                      - charset, string(6): Content encoding, UTF8 or BASE64. Default is UTF8
                      - switch, int, If the original sending SIM card is unavailable, should the system be allowed to automatically switch cards(0 or 1, default 0)
                      
                filename.extension:
                  description: Subsequent form fields represent MMS attachments. Attachment names should be simple, without directory paths—use only the format  `filename.extension`
                  type: file   
      responses:  
        '200':
          description: 'OK'
          content:
            application/json:
              example:
                version: V1.0
                seq: 13
                status: 0
                reason: success
                msgId: 125
                receiver: 10086
                switch: 0   
              schema:
                type: object
                required:
                  - status
                  - version
                  - seq
                  - reason
                  - msgId
                  - receiver
                  - switch
                properties:
                   version:
                     type: string
                     description: 
                     example: V1.0
                   seq: 
                     type: int
                     description: Sequence number from request, if provided, returned
                   status:
                     type: int
                     description: >-
                       Submission status: 
                        - 0 = success
                        - non-zero = failure
                   reason:
                     type: string
                     description: Failure reason, if any
                   msgId:
                     type: string
                     description: System-generated message ID for tracking delivery reports
                   receiver:
                     type: string
                     description: Single recipient phone number, one per msgId
                   switch:
                     type: int
                     description: Whether card switch occurred (0 or 1)
                   
          headers: {}
      security: []
  http://ip:20003/chat_report:
    get:
      summary: Query Delivery Report
      deprecated: false
      description: >-
        Users can proactively retrieve chat delivery reports using a GET request.
        The report content is returned in JSON format within the response body.
        A maximum of 50 delivery reports can be retrieved at once
      parameters:
        - name: version
          in: query
          description: Protocol version number
          schema:
            type: string(8)
            default: '1.0'
        - name: account
          in: query
          description: Account
          required: true
          schema:
            type: string(32)
        - name: password
          in: query
          description: Password
          required: true
          schema:
            type: string(32)
        - name: seq
          in: query
          description: >-
            Serial number，increments per request，the initial value is 1.
          required: true
          schema:
            type: string
        - name: time
          in: query
          description: >-
             The timestamp form which the request was mode. 
          
          
              **Must be filled when the server requires encryption**
          schema:
            type: int
        - name: chatId
          in: query
          required: true
          description: >-
            The msgId(s) to query, separated by commas for multiple entries. **Maximum of 50 msgIds per query.**
            msgId refers to the msgId submitted to the chat system for a reply
          schema:
            type: string(2048)
      responses:
        '200':
          description: 'OK'
          content:
            application/json:
              example:
                status: 0
                seq: 2
                ver: V1.0
                cnt: 2
                notfount_cnt: 1
                waiting_cnt: 1
                array:
                  - isChat: 1
                    msgId: 123
                    chatId: 1234abcd
                    receiver: 10001
                    submittm: timestamp
                    sendtm: timestamp
                    donetm: timestamp
                    status: 0
                    reason: success
                  - isChat: 1
                    msgId: 124
                    chatId: 1235abcd
                    reciver: 10086
                    submittm: timestamp
                    sendtm: timestamp
                    donetm: timestamp
                    status: 0
                    reason: success
                notfound_array: 
                  - msgId: 334
                waiting_array:
                  - msgId: 456
              schema:
                type: object
                required:
                  - version
                  - status
                  - reason
                  - seq 
                  - cnt
                  - array
                  - notfound_cnt
                  - notfound_array
                  - waiting_cnt
                  - waiting_array
                properties:
                   version:
                     type: string
                     description: Protocol version
                   status:
                     type: int
                     description: >-
                        Send submission status, code and details:
                         - 0: Success
                         - Others: Failure
                   reason:
                     type: string
                     description: Failure reason, if any
                   seq:
                     type: string
                     description: Sequence number from request, if provided, returned
                   cnt:
                     type: int
                     description: Number of numbers retrieved 
                   array:
                     type: array
                     description: >-
                         Array of delivery reports
                     items:
                       type: array
                       items:
                        type: object
                        properties:
                          isChat:
                            type: int
                            description: >-
                              Flag indicating chat message: 
                               - 1 = chat
                               - 0 = non-chat
                          msgId:
                            type: string
                            description: System-generated message ID
                          chatId: 
                            type: string
                            description: System-generated chat ID
                          receiver:
                            type: string
                            description: Single recipient phone number, one per msgId
                          submittm:
                            type: int
                            description: SMS submission timestamp
                          sendtm:
                            type: int
                            description: SMS send timestamp
                          donetm:
                            type: int
                            description: SMS completion timestamp
                          status: 
                            type: int
                            description: >- 
                              Send result: 
                               - 0 = success
                               - non-zero = failure
                          reason:
                            type: string
                            description: Failure reason description
                   notfount_cnt:
                     type: int
                     description: Count of msgIds not found
                   notfount_array: 
                     type: array
                     description: Array of not found msgIds
                   waiting_cnt:
                     type: int
                     description: Count of msgIds pending sending
                   waiting_array:
                     type: array
                     description: Array of msgIds still waiting to send
          headers: {}
      security: []
  Configuration of a delivery report push URL for each consumer account:
    post:
      summary: Active Push - Delivery Report 
      deprecated: false
      description: >-
        The system allows configuration of the push URL for consuming users. 
        After sending an SMS, the system will push the delivery result to the customer's specified URL via a POST request. The report content is placed in the request body in JSON format.
        A maximum of 50 delivery reports can be pushed at once
      requestBody:
          content:
            application/json:
              schema:
                type: object
                properties:
                  ver:
                    type: string
                    description: Protocol version
                  type:
                    type: string
                    const: report
                    description: The string type of the message
                  cnt:
                    type: int
                    description: Number of reports in current push(max 50)
                  seq:
                    type: int
                    description: Sequence number, increments per request
                  array:
                    type: array
                    items:
                      type: object
                      required:
                        - isChat
                        - msgId
                        - chatId
                        - receiver
                        - submittm
                        - sendtm
                        - donetm
                        - status
                        - reason
                      properties:
                        isChat:
                          type: int
                          description: >-
                            Flag indicating chat message: 
                             - 1 = chat
                             - 0 = non-chat
                        msgId:
                          type: string
                          description: System-generated message ID
                        chatId:
                          type: string
                          description: System-generated chat ID
                        receiver:
                          type: string
                          description: Single recipient phone number, one per msgId
                        submittm:
                          type: int
                          description: SMS submission timestamp
                        sendtm:
                          type: int
                          description: SMS send timestamp
                        donetm:
                          type: int
                          description: SMS completion timestamp
                        status:
                          type: int
                          description: >-
                            Send result: 
                             - 0 = success
                             - non-zero = failure
                        reason:
                          type: string
                          description: Failure reason description
                    description: Array of delivery reports
                required:
                  - type
                  - cnt
                  - version
                  - array
                  - seq
              examples:
                '1':
                  summary: Push sample
                  value: 
                    type: report
                    version: V1.0
                    cnt: 2
                    array:
                      - isChat: 1
                        msgId: 123
                        chatId: 1234abcd
                        receiver: 10001
                        submittm: timestamp
                        sendtm: timestamp
                        donetm: timestamp
                        status: 0
                        reason: success
                      - isChat: 1
                        msgId: 124
                        chatId: 1235abcd
                        reciver: 10086
                        submittm: timestamp
                        sendtm: timestamp
                        donetm: timestamp
                        status: 0
                        reason: success
          headers: {}
      security: []
  Configuration of a sms report push URL for each consumer account:
    post:
      summary: Active Push - Incoming SMS 
      deprecated: false
      description: >-
        The system allows configuration of the push URL for consuming users. Upon receiving an SMS, 
        the system will push the received message to the customer's specified URL via a POST request.
        A maximum of 50 delivery reports can be pushed at once
      requestBody:
          content:
            application/json:
              schema:
                type: object
                properties:
                  ver:
                    type: string
                    description: Protocol version
                  type:
                    type: string
                    const: chat_recvsms
                    description: The string type of the message
                  cnt:
                    type: int
                    description: Number of reports in current push(max 50), **required when encryption is enabled**
                  seq:
                    type: int
                    description: Sequence number, increments per request
                  array:
                    type: array
                    items:
                      type: object
                      required:
                        - chatId
                        - receiver
                        - recvtm
                        - sms
                      properties:
                        chatId:
                          type: string
                          description: System-generated chat ID
                        receiver:
                          type: string
                          description: Single recipient phone number, one per msgId
                        recvtm:
                          type: int
                          description: Timestamp of SMS receipt
                        sms:
                          type: int
                          description: SMS content
                    description: Array of delivery reports
                required:
                  - type
                  - cnt
                  - version
                  - array
                  - seq
              examples:
                '1':
                  summary: Push sample
                  value: 
                    type: recvsms
                    ver: V1.0
                    cnt: 1
                    seq: 3
                    array:
                      - chatId: 1234abcd
                        receiver: 10001
                        recvtm: 1744696196
                        sms: nice

          headers: {}
      security: []
  Configuration of a mms report push URL for each consumer account:
    post:
      summary: Active Push - Incoming MMS 
      deprecated: false
      description: >-
        The system allows configuring a consumer user’s push URL. After the system receives an MMS, it will push the received MMS to the client’s specified URL via HTTP POST.
        
        
        **The HTTP header must include: Content-Type: multipart/form-data**
        
        
        <span style="color:red;font-weight:bold">Multipart form submission, first form named mms_body contains JSON similar to SMS reply plus title for MMS subject</span>
        
        
        <span style="color:red;font-weight:bold">Other forms contain attachments named `<filename>.<extension>`, no directory paths</span>
         ![sendmms](https://raw.githubusercontent.com/ejoin-api/eims-chat/main/docs/chatrecv.png)
      requestBody:
          content:
            multipart/form-data:
              example:
                {"version":"V1.0","type":"chat_recvmms","seq":1,"charset":"UTF8","chatId":"1234abcd","recvtm":"timestamp","receiver":"87654321","title":"MMStitle","sms":"MMSTest"}  
              schema:
                type: object   
                properties:
                  mmsbody:
                    type: string
                    description: >-
                      JSON message format:
                        - version: string, protocol version number
                        - type: string, **required**, the string type of the message, default：`chat_recvmms`
                        - seq: int, sequence number, incremented with each request, initial value is 1,  **required when encryption is enabled**
                        - chatId: string, **required**, the chatId generated by the system upon submission
                        - receiver: string,	**required**, recipient phone number
                        - recvtm: string, **required**, timestamp when the MMS was received
                        - charset: string, content encoding, either UTF8 or BASE64, default is UTF8
                        - title: string, MMS subject
                        - sms: string, MMS text content; this field may be empty
                  Other form fields represent the MMS attachments:
                    type: file
                    description: >-
                      <span style="font-weight: bold;color: red">Content-Disposition: form-data; filename="filename"</span>
                      
                      
                      <span style="font-weight: bold;color: red">File naming format: MD5 value of file content.file extension</span>
          headers: {}
      security: []
     